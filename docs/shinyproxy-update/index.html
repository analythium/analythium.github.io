<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.56">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Analythium Hub Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Analythium Hub Blog Atom Feed">
<script src="https://www.googletagmanager.com/gtag/js?id=UA-147215898-3" async></script>
<script src="gascript.js"></script>
<script src="https://cdn.usefathom.com/script.js" data-site="XXTESXHY" defer="defer"></script><title data-react-helmet="true">Update ShinyProxy | Analythium Hub</title><meta data-react-helmet="true" property="og:image" content="https://hub.analythium.io/img/hub-thumb.png"><meta data-react-helmet="true" property="twitter:image" content="https://hub.analythium.io/img/hub-thumb.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Analythium Hub"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Update ShinyProxy | Analythium Hub"><meta data-react-helmet="true" name="description" content="Once your ShinyProxy server is up and running, you need to maintain and update it."><meta data-react-helmet="true" property="og:description" content="Once your ShinyProxy server is up and running, you need to maintain and update it."><meta data-react-helmet="true" property="og:url" content="https://hub.analythium.io/docs/shinyproxy-update"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://hub.analythium.io/docs/shinyproxy-update"><link rel="stylesheet" href="/styles.d0f00354.css">
<link rel="preload" href="/styles.b9b32f90.js" as="script">
<link rel="preload" href="/runtime~main.dbf1f8dc.js" as="script">
<link rel="preload" href="/main.3c4e732c.js" as="script">
<link rel="preload" href="/1.bea984e9.js" as="script">
<link rel="preload" href="/2.68b92899.js" as="script">
<link rel="preload" href="/3.a83cd0b4.js" as="script">
<link rel="preload" href="/1be78505.4d532cf0.js" as="script">
<link rel="preload" href="/47.72b6c03e.js" as="script">
<link rel="preload" href="/20ac7829.9b5e15af.js" as="script">
<link rel="preload" href="/0fe18dbf.c53aada9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top navbarHideable_OaSq"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a href="https://hub.analythium.io/" target="_self" rel="noopener noreferrer" class="navbar__brand" to="https://hub.analythium.io/"><img class="navbar__logo" src="/img/logo.svg" alt="Analythium Logo"><strong class="navbar__title">Analythium Hub</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/blog/">News</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/analythium/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://hub.analythium.io/" target="_self" rel="noopener noreferrer" class="navbar__brand" to="https://hub.analythium.io/"><img class="navbar__logo" src="/img/logo.svg" alt="Analythium Logo"><strong class="navbar__title">Analythium Hub</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/blog/">News</a></li><li class="menu__list-item"><a href="https://github.com/analythium/" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs sidebarWithHideableNavbar_1-U5"><a href="https://hub.analythium.io/" target="_self" rel="noopener noreferrer" tabindex="-1" class="sidebarLogo_3ono" to="https://hub.analythium.io/"><img src="/img/logo.svg" alt="Analythium Logo"><strong>Analythium Hub</strong></a><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/introduction">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Shiny</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/shiny">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/shiny-ui">Shiny UI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/shiny-server">Server Function</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/shiny-app">Shiny App</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Containers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/containers">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/containers-docker">Docker Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/containers-shiny">Shiny in Docker</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">ShinyProxy</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/shinyproxy">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/shinyproxy-setup">Set Up ShinyProxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/shinyproxy-secure">Secure ShinyProxy</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/shinyproxy-update">Update ShinyProxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/shinyproxy-webhook">CI/CD with Webhook</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Update ShinyProxy</h1></header><div class="markdown"><p><a href="https://hosting.analythium.io/?utm_source=as-hub&amp;utm_medium=web&amp;utm_campaign=evergreen" target="_blank" rel="noopener noreferrer"><img src="https://hub.analythium.io/assets/marks/hosting-banner-2.jpg" alt="Hosting Data Apps"></a></p><p>Once your ShinyProxy server is up and running, you need to maintain and update it.
This section explains how to update existing apps and how to add new ones hassle free.</p><p><a href="https://marketplace.digitalocean.com/apps/shinyproxy?refcode=a8041699739d" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/analythium/shinyproxy-1-click/master/digitalocean/images/do-btn-blue.svg" alt="DO button"></a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="edit-configuration"></a>Edit configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#edit-configuration" title="Direct link to heading">#</a></h2><p>Create and <code>application.yml</code> file or use the file in the <a href="/docs/shinyproxy-setup">previous</a> section as a starting point. The file is also available <a href="https://github.com/analythium/shinyproxy-1-click/blob/master/digitalocean/application.yml">here</a>.</p><p>The most important part is adding apps:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-vim codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">  - id: 02_hello</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    display-name: Demo Shiny App</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    description: App with sliders and large file upload</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    container-cmd: [&quot;R&quot;, &quot;-e&quot;, &quot;shiny::runApp(&#x27;/root/app&#x27;)&quot;]</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    container-image: analythium/shinyproxy-demo:latest</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    logo-url: https://github.com/analythium/shinyproxy-1-click/raw/master/digitalocean/images/app-dots.png</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    access-groups: [admins]</span></div></div></div></div></div><p>The keys for the apps are the following (see the official <a href="https://www.shinyproxy.io/documentation/configuration/#apps" target="_blank" rel="noopener noreferrer">docs</a>). The three most important ones are:</p><ul><li><code>id</code>: the identifier of the application, this will also be part of the path to the app</li><li><code>container-cmd</code>: the command that will be run when the Docker container is launched</li><li><code>container-image</code>: name of the docker image to be started for every new user of this app</li></ul><p>The Docker images need to be pulled beforehand. If you are using private images, <code>docker login</code> will also be required before pulling images.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="docker-login"></a>Docker login<a aria-hidden="true" tabindex="-1" class="hash-link" href="#docker-login" title="Direct link to heading">#</a></h2><p>This step is optional if private registry access is needed for pulling Docker images.</p><p>Log into your droplet via ssh and lig into your registry via <code>docker login</code>
(Docker Hub by default, use <code>docker login registry.gitlab.com</code> for the GitLab
container registry). You will be asked to authenticate interactively
and your personal access token will be saved on the droplet for future use.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="update-script"></a>Update script<a aria-hidden="true" tabindex="-1" class="hash-link" href="#update-script" title="Direct link to heading">#</a></h2><p>Once your <code>application.yml</code> is ready, <code>cd</code> into the directory where the configuration file is located and download the following <a href="https://github.com/analythium/shinyproxy-1-click/blob/master/digitalocean/setup.sh">script file</a>:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">wget</span><span class="token plain"> -O ./update.sh https://raw.githubusercontent.com/analythium/shinyproxy-1-click/master/digitalocean/setup.sh</span></div></div></div></div></div><p>Use the <code>setup.sh</code> as:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">bash</span><span class="token plain"> setup.sh -i ~/.ssh/id_rsa -s root@ip_address -f application.yml</span></div></div></div></div></div><p>The following command line arguments need to be passed to the <code>setup.sh</code> script:</p><ul><li><code>-i</code>: path to your ssh key,</li><li><code>-s</code>: user name (root for DigitalOcean droplets) and the IP address: <code>user@ip_address</code>,</li><li><code>-f</code>: path and file name to the yml with the ShinyProxy config, e.g. <code>/path/to/application-new.yml</code>.</li></ul><p>The script then takes care of the rest:</p><ol><li>Copies the <code>application.yml</code> to the droplet,</li><li>pulls the Docker images listed in the <code>application.yml</code> file: updates the ones already pulled before, and the ones newly added too,</li><li>and restarts the ShinyProxy and Docker services.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="cron"></a>Cron<a aria-hidden="true" tabindex="-1" class="hash-link" href="#cron" title="Direct link to heading">#</a></h2><p>If the config file is not changing (i.e. no new apps added), you can set up cron job to regularly update the images that are already pulled to the server.</p><p>We have access to the cron utility: run <code>crontab -e</code>,
pick an editor (nano) if you haven&#x27;t done so already and then add
these lines to the bottom and save it:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Cleanup at 3:00am every Sunday</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">0</span><span class="token plain"> </span><span class="token number">3</span><span class="token plain"> * * </span><span class="token number">0</span><span class="token plain"> docker system prune -f</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Update all images at 1:00am every day</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">0</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> * * * docker images </span><span class="token operator">|</span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> -v REPOSITORY</span><span class="token operator">|</span><span class="token function" style="color:rgb(80, 250, 123)">awk</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;{print </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;:&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$2</span><span class="token string" style="color:rgb(255, 121, 198)">}&#x27;</span><span class="token operator">|</span><span class="token function" style="color:rgb(80, 250, 123)">xargs</span><span class="token plain"> -L1 docker pull</span></div></div></div></div></div><p>The cleanup command removes dangling (not needed) images that take up unnecessary space.</p><p>The second command updates all the images that are already present.</p><p>Check settings using <code>crontab -l</code>.</p><p>Cron jobs represent a polling type of update, which means we are regularly checking for updates. However, if changes to the images are infrequent, there is no need for constant polling. Setting cron intervals too large might lead to missing important updates.</p><p><img src="../../img/shinyproxy/webhook.png" alt="API polling vs webhook" title="API polling vs webhook"></p><p>Webhooks in general are <a href="https://blog.cloud-elements.com/webhooks-vs-polling-youre-better-than-this" target="_blank" rel="noopener noreferrer">considered a better alternative to polling</a>, although webhooks require a bit more work. The next section will explain how to do it.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Further reading</h5></div><div class="admonition-content"><ul><li><a href="https://www.digitalocean.com/community/tutorials/how-to-use-cron-to-automate-tasks-ubuntu-1804" target="_blank" rel="noopener noreferrer">Cron guide</a></li></ul></div></div><p><a href="https://hosting.analythium.io/?utm_source=as-hub&amp;utm_medium=web&amp;utm_campaign=evergreen" target="_blank" rel="noopener noreferrer"><img src="https://hub.analythium.io/assets/marks/hosting-banner-2.jpg" alt="Hosting Data Apps"></a></p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/analythium/analythium.github.io/edit/source/docs/shinyproxy-update.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2023-02-02T02:15:09.000Z" class="docLastUpdatedAt_1sqk">2/2/2023</time> by <strong>Peter Solymos</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/shinyproxy-secure"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Secure ShinyProxy</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/shinyproxy-webhook"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">CI/CD with Webhook »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#edit-configuration" class="table-of-contents__link">Edit configuration</a></li><li><a href="#docker-login" class="table-of-contents__link">Docker login</a></li><li><a href="#update-script" class="table-of-contents__link">Update script</a></li><li><a href="#cron" class="table-of-contents__link">Cron</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/analythium" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://www.linkedin.com/company/analythium/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Links</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.analythium.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Analythium.io</a></li><li class="footer__item"><a href="https://blog.analythium.io" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://blog.analythium.io">Analythium blog</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.analythium.io/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy policy</a></li><li class="footer__item"><a href="https://www.analythium.io/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://www.analythium.io/terms/">Terms of service</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://hub.analythium.io" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1Wg7"><img class="footer__logo" alt="Analythium Logo" src="https://hub.analythium.io/assets/marks/word-mark-dark-yellow-wide.png"></a></div><div>Copyright © 2023 Analythium Solutions Inc.</div></div></div></footer></div>
<script src="/styles.b9b32f90.js"></script>
<script src="/runtime~main.dbf1f8dc.js"></script>
<script src="/main.3c4e732c.js"></script>
<script src="/1.bea984e9.js"></script>
<script src="/2.68b92899.js"></script>
<script src="/3.a83cd0b4.js"></script>
<script src="/1be78505.4d532cf0.js"></script>
<script src="/47.72b6c03e.js"></script>
<script src="/20ac7829.9b5e15af.js"></script>
<script src="/0fe18dbf.c53aada9.js"></script>
</body>
</html>